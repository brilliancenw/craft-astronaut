{% import "_includes/forms" as forms %}

<div class="readable">
    {% if missingRocketLauncher is defined and missingRocketLauncher %}
        <div style="background: #fef3c7; border: 2px solid #f59e0b; border-radius: 8px; padding: 20px; margin-bottom: 24px;">
            <h3 style="color: #92400e; margin-top: 0; font-size: 18px;">ðŸš€ Houston, We Have a Problem!</h3>
            <p style="color: #78350f; margin: 8px 0;">
                You're trying to launch an Astronaut without a Rocket Launcher!
                This plugin requires the free <strong>Rocket Launcher</strong> plugin to function.
            </p>
            <p style="margin: 16px 0 0 0;">
                <a href="https://plugins.craftcms.com/rocket-launcher" target="_blank" class="btn submit" style="display: inline-block;">
                    Install Rocket Launcher from Plugin Store â†’
                </a>
            </p>
        </div>
    {% endif %}

    <h2>API Keys</h2>
    <p>Configure your AI provider API keys. These keys are encrypted and stored securely in the database.</p>

    {% if tablesNotReady is defined and tablesNotReady %}
        <div style="background: #fef3c7; border: 2px solid #f59e0b; padding: 16px; border-radius: 8px; margin-bottom: 24px;">
            <h3 style="margin-top: 0; color: #92400e;">Database Tables Pending</h3>
            <p><strong>Environment variables detected!</strong> Your API keys are configured and working.</p>
            <p>To enable database storage and full functionality, run migrations:</p>
            <pre style="background: #1e293b; color: #e2e8f0; padding: 12px; border-radius: 4px; margin: 12px 0;"><code>/Applications/MAMP/bin/php/php8.2.26/bin/php craft migrate/all</code></pre>
        </div>
    {% endif %}

    <h3>Claude (Anthropic)</h3>

    {{ forms.autosuggestField({
        label: 'Claude API Key',
        id: 'claudeApiKey',
        name: 'claudeApiKey',
        value: settings['claudeApiKey'] ?? '',
        suggestEnvVars: true,
        suggestions: craft.cp.getEnvSuggestions(),
        placeholder: 'sk-ant-... or $LAUNCHER_CLAUDE_API_KEY',
        autocomplete: false
    }) }}

    <p class="light"><a href="https://console.anthropic.com/settings/keys" target="_blank" rel="noopener">Get your API key from Anthropic Console</a></p>

    <hr>

    <h3>OpenAI (Coming Soon)</h3>

    {{ forms.autosuggestField({
        label: 'OpenAI API Key',
        instructions: 'OpenAI provider support coming soon.',
        id: 'openaiApiKey',
        name: 'openaiApiKey',
        value: settings['openaiApiKey'] ?? '',
        suggestEnvVars: true,
        suggestions: craft.cp.getEnvSuggestions(),
        placeholder: 'sk-... or $LAUNCHER_OPENAI_API_KEY',
        disabled: true,
        autocomplete: false
    }) }}

    <hr>

    <h3>Gemini (Google - Coming Soon)</h3>

    {{ forms.autosuggestField({
        label: 'Gemini API Key',
        instructions: 'Gemini provider support coming soon.',
        id: 'geminiApiKey',
        name: 'geminiApiKey',
        value: settings['geminiApiKey'] ?? '',
        suggestEnvVars: true,
        suggestions: craft.cp.getEnvSuggestions(),
        placeholder: 'AI... or $LAUNCHER_GEMINI_API_KEY',
        disabled: true,
        autocomplete: false
    }) }}

    <hr>

    <div class="readable" style="margin-top: 24px;">
        <h3>Getting API Keys</h3>

        <h4>Claude (Anthropic)</h4>
        <ol>
            <li>Visit <a href="https://console.anthropic.com/" target="_blank" rel="noopener">console.anthropic.com</a></li>
            <li>Sign up or log in to your account</li>
            <li>Navigate to API Keys section</li>
            <li>Create a new API key</li>
            <li>Copy and paste it above or add to your .env file</li>
        </ol>

        <p><strong>Pricing:</strong> Claude API uses a pay-as-you-go model. Visit <a href="https://www.anthropic.com/pricing" target="_blank" rel="noopener">anthropic.com/pricing</a> for current rates.</p>
    </div>
</div>
